@use 'sass:map';

/* stylelint-disable nesting-selector-no-missing-scoping-root */
/*
  $bg-color: background color of the element.
  $color: colour of the outline.
  Sets the focus outline inside the element, by using multiple box shadows
*/
@mixin lg-inner-focus-outline(
  $bg-color: var(--default-focus-color),
  $color: var(--colour-greyscale-0)
) {
  outline: 0;
  box-shadow:
    inset 0 0 0 0.25rem $bg-color,
    inset 0 0 0 0.3rem $color;
}

@mixin lg-focus-outline(
  $bg-color: var(--default-focus-color),
  $inner-bg-color: var(--default-inner-focus-color)
) {
  outline: 0 !important;
  box-shadow:
    0 0 0 var(--inner-focus-width) $inner-bg-color,
    0 0 0 var(--outer-focus-width) $bg-color;
}

@mixin lg-link(
  $default-color: var(--link-color),
  $hover-color: var(--link-hover-color),
  $visited-color: var(--link-visited-color),
  $active-color: var(--link-active-color),
  $active-bg-color: var(--link-active-bg-color),
  $focus-color: var(--link-focus-color),
  $focus-bg-color: var(--link-focus-bg-color)
) {
  $box-shadow-inset-width: -0.063rem;

  border-bottom: 0.125rem solid $default-color;
  color: $default-color;
  line-height: initial;
  padding: 0 0.125rem;
  text-decoration: none;

  &:hover,
  &:hover:visited {
    color: $hover-color;
    border-bottom: 0;
    box-shadow:
      inset 0 $box-shadow-inset-width 0 0 $hover-color,
      0 0.188rem 0 0 $hover-color;
  }

  &:visited {
    color: $visited-color;
    border-color: $visited-color;
  }

  &:active {
    background-color: $active-bg-color;
    border-bottom-color: $active-color;
    color: $active-color;
    outline: 0;
  }

  &:focus-visible,
  &:focus-visible:hover {
    background-color: $focus-bg-color;
    border-bottom: 0;
    color: $focus-color;
    outline: 0.063rem solid $focus-bg-color;
    outline-offset: 0;
  }
}

@mixin lg-unstyled-link() {
  text-decoration: underline;
  border-bottom: 0;
  padding: 0;

  &:hover {
    border-bottom: 0;
    box-shadow: none;
    background-color: transparent;
    color: inherit;
  }

  &:active,
  &:focus-visible,
  &:focus-visible:hover {
    background-color: transparent;
    color: inherit;
  }

  &:focus-visible,
  &:focus-visible:hover {
    @include lg-focus-outline();
  }
}

@mixin lg-font-size($size, $modifier: null, $type: null) {
  font-size: var(--font-size-#{$size});
  line-height: var(--line-height-#{$size});

  @if $type {
    font-family: var(--font-family-#{$type});
  }

  $weight: '400';

  @if $type == 'expressive' {
    $weight: '500';
  }

  @if $modifier {
    $weight: $modifier;
  }

  font-weight: var(--font-weight-#{$weight});
}

@mixin lg-visually-hidden {
  border: 0 !important;
  clip-path: inset(50%) !important;
  height: auto !important;
  margin: 0 !important;
  overflow: hidden !important;
  padding: 0 !important;
  position: absolute !important;
  width: 0.0625em !important;
  white-space: nowrap !important;
}

$breakpoints: (
  // 0
  'sm': 0,
  // 768
  'md': 48rem,
  // 1024
  'lg': 64rem,
  // 1280
  'xl': 80rem,
  // 1440
  'xxl': 90rem
) !default;

/*
  $breakpoint: string value for the breakpoint screen size.
  $range: 'min-width' or 'max-width' (legacy) or 'range'
  $max-breakpoint: optional - when $range is 'range', specify the max breakpoint name
  Creates a mixin which allows breakpoints to be added to css blocks
*/
@mixin lg-breakpoint($breakpoint, $range: 'min-width', $max-breakpoint: null) {
  @if map.has-key($breakpoints, $breakpoint) {
    $value: map.get($breakpoints, $breakpoint);

    @if $range == 'max-width' {
      // Removes 1 pixel if using max-width so that there is no
      // overlap when used with min-width.
      $value: $value - 0.06rem;

      @media ($range: $value) {
        @content;
      }
    } @else if $range == 'range' {
      // New range functionality - creates combined min and max media query
      @if $max-breakpoint and map.has-key($breakpoints, $max-breakpoint) {
        $max-value: map.get($breakpoints, $max-breakpoint) - 0.06rem;

        // Handle sm breakpoint (value 0) - only use max-width
        @if $value == 0 {
          @media (max-width: $max-value) {
            @content;
          }
        } @else {
          @media (min-width: $value) and (max-width: $max-value) {
            @content;
          }
        }
      } @else {
        @warn "Range mode requires a valid max-breakpoint. "
          + "Available breakpoints are: #{map.keys($breakpoints)}.";
      }
    } @else {
      // Default min-width behavior
      @media ($range: $value) {
        @content;
      }
    }
  } @else {
    @warn "Unfortunately, no value could be retrieved from `#{$breakpoint}`. "
      + "Available breakpoints are: #{map.keys($breakpoints)}.";
  }
}

@mixin lg-status() {
  // Uses status tokens from status.css
  background-color: var(--container-status-background-colour) !important;
  color: var(--text-status-primary-colour) !important;

  a:not(.lg-btn) {
    @include lg-link(
      $default-color: var(--interactive-text-status-rest),
      $hover-color: var(--interactive-text-status-hover),
      $visited-color: var(--interactive-text-status-visited),
      $active-color: var(--interactive-text-status-active),
      $active-bg-color: var(--container-status-background-colour),
      $focus-color: var(--interactive-status-focus-colour),
      $focus-bg-color: var(--interactive-status-focus-background-colour)
    );
  }

  .lg-btn--secondary-dark {
    background-color: transparent !important;
    border-color: var(--text-status-primary-colour) !important;
    color: var(--text-status-primary-colour) !important;

    &:hover {
      background-color: var(--interactive-status-hover-background-colour) !important;
      border-color: var(--interactive-status-hover-border-colour) !important;
      color: var(--interactive-status-hover-colour) !important;
    }

    &:active {
      background-color: var(--interactive-status-active-background-colour) !important;
      border-color: var(--interactive-status-active-border-colour) !important;
      color: var(--interactive-status-active-colour) !important;
    }

    &:focus-visible {
      background-color: var(--interactive-status-focus-background-colour) !important;
      border-color: var(--interactive-status-focus-border-colour) !important;
      color: var(--interactive-status-focus-colour) !important;
    }

    &:disabled {
      background-color: var(--interactive-status-disabled-background-colour) !important;
      border-color: var(--interactive-status-disabled-border-colour) !important;
      color: var(--interactive-status-disabled-colour) !important;
    }
  }
}

@mixin lg-card {
  background-color: var(--card-bg-color);
  border-radius: var(--border-radius-lg);
  margin-bottom: var(--grid-gutter);
  padding: var(--component-padding);
}

@mixin lg-typography-default {
  font-size: var(--text-base-size);
  font-weight: var(--font-weight-400);
  font-family: var(--font-family);
  line-height: var(--text-base-line-height);
  color: var(--text-default);
}

@mixin lg-paragraph {
  font-size: var(--font-size-1);
  margin-bottom: var(--text-bottom-margin);

  &:last-child {
    margin-bottom: 0;
  }
}

@mixin lg-list-margin {
  margin-left: var(--space-unit);
  margin-bottom: var(--text-bottom-margin);
}

@mixin lg-canopy-element-typography {
  html,
  body,
  input,
  select {
    @include lg-typography-default;
  }

  p {
    @include lg-paragraph;
  }

  a {
    @include lg-link;
  }

  b,
  strong {
    font-weight: var(--font-weight-700);
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    display: block;
    margin-bottom: var(--text-bottom-margin);
  }

  h1 {
    @include lg-font-size('5');
  }

  h2 {
    @include lg-font-size('4');
  }

  h3 {
    @include lg-font-size('3');
  }

  h4 {
    @include lg-font-size('2');
  }

  h5 {
    @include lg-font-size('1');
  }

  h6 {
    @include lg-font-size('0-8');
  }

  small {
    @include lg-font-size('0-6');
  }

  ul,
  ol {
    @include lg-list-margin;
  }
}

@mixin lg-nav-item() {
  appearance: none;
  box-shadow: none;
  border: 0;
  background: var(--nav-item-bg-color);
  color: var(--nav-item-color);
  cursor: pointer;
  text-decoration: none;
  margin-bottom: 0;
  line-height: 1.5;
  border-radius: var(--nav-item-border-radius);
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;

  &::after {
    content: '';
    position: absolute;
    height: 0.125rem;
    border-radius: var(--nav-item-border-radius);
    background-color: transparent;
    bottom: 0;
    left: 0.188rem;
    right: 0.188rem;
  }

  > .lg-icon {
    height: var(--nav-item-icon-height);
    width: auto;
  }

  &:focus-visible,
  &:hover:focus-visible {
    background-color: var(--nav-item-bg-color-hover);
    color: var(--nav-item-color-hover);

    &::after {
      background-color: var(--nav-item-border-color-hover);
    }

    @include lg-focus-outline(
      var(--default-focus-color),
      var(--default-inner-focus-color)
    );
  }

  &:hover,
  &:hover:visited {
    border: 0;
    background-color: var(--nav-item-bg-color-hover);
    color: var(--nav-item-color-hover);
    box-shadow: none;

    &::after {
      background-color: var(--nav-item-border-color-hover);
    }
  }

  &--active {
    border: 0;
    background-color: var(--nav-item-bg-color-active);

    &:visited::after,
    &:visited:hover::after,
    &:hover::after,
    &::after {
      background-color: var(--nav-item-border-color-active);
      height: 0.25rem;
      color: var(--nav-item-color-active);
    }

    &[type='button'],
    &[type='button']:hover,
    &[type='button']:hover:focus-visible {
      background-color: var(--nav-item-bg-color-expanded);
      color: var(--nav-item-color-expanded);

      .lg-notification-badge {
        color: var(--text-default);
        background-color: var(--nav-item-bg-color);
      }

      &::after {
        background-color: var(--nav-item-border-color-hover);
        height: 0.25rem;
      }
    }
  }
}
/* stylelint-enable nesting-selector-no-missing-scoping-root */
