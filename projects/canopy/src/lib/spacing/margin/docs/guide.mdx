import { Meta, Markdown } from '@storybook/addon-docs/blocks';
import Feedback from '../../../docs/common/feedback.md';
import { getDefaultSpacingVariables } from '../../../docs/foundation/spacing-utils';

<Meta title="Helpers/Directives/Margin/Guide"/>

# Margin

This directive allows for a custom margin to be added without the need to write additional CSS. It's useful for overriding the default margin on Canopy components, as well as general use within your app. Using this directive ensures that your margin adheres to the predefined spacing variables and breakpoints in Canopy. The spacing variables are also available as CSS custom properties (CSS variables) which can be viewed in ***canopy/projects/canopy/src/styles/spacing.scss***.

## Usage

Import the margin directive in your application:

```js
imports: [ ..., LgMarginDirective ]
```

In your HTML, apply the directive to the relevant component. If the default `lgMargin` attribute has no value, the default margin will remain. You can also override individual margin such as `margin-top` by applying the relevant selector/input (.e.g `LgMarginTop` - see the **inputs table** below).

Pass in **Spacing variant** (see below).

```html
<lg-card lgMargin="4"></lg-card>
```

## Spacing

### Spacing variants

This is set of predefined variants as defined by the `SpacingVariant` type. These are:

<pre><code className="language-text">
{(() => {
  const spacingVars = getDefaultSpacingVariables();
  const variants = Object.keys(spacingVars)
    .filter(key => key.startsWith('--space-'))
    .map(key => key.replace('--space-', ''))
    .sort((a, b) => {
      // Handle 'none' specially
      if (a === 'none') return -1;
      if (b === 'none') return 1;
      // Sort numbers numerically
      return parseInt(a) - parseInt(b);
    })
    .map(variant => `'${variant}'`)
    .join(', ');

  return `'none', ${variants}`;
})()}
</code></pre>

### Variant examples

Apply `8` margin to the bottom

```html

<lg-card lgMarginBottom="8"></lg-card>

```

Apply `4` margin to the left and right

```html

<lg-card lgMarginHorizontal="4"></lg-card>

```

Apply `7` margin all round, but `9` margin to the bottom

```html

<lg-card lgMargin="7" lgMarginBottom="9"></lg-card>

```

Apply `6` margin to the top and bottom

```html

<lg-card lgMarginVertical="6"></lg-card>

```

### None at breakpoint

When using responsive spacing variables, you may need to set margin to none (zero) at a specific breakpoint. Use the `NoneAt` inputs for this:

Apply `4` margin on all sides, but set to none at `sm` breakpoint

```html

<lg-card lgMargin="4" lgMarginNoneAt="sm"></lg-card>

```

Apply `5` margin to the right, but set to none at the `md` breakpoint

```html

<lg-card lgMarginRight="5" lgMarginRightNoneAt="md"></lg-card>

```

Apply `6` margin on top and bottom, but set to none at the `lg` breakpoint

```html

<lg-card lgMarginVertical="6" lgMarginVerticalNoneAt="lg"></lg-card>

```

#### How NoneAt works with responsive spacing

The `NoneAt` inputs create **breakpoint-specific overrides** that only apply within a specific breakpoint range. This is particularly useful when working with responsive spacing CSS variables (like `--space-8`) that change values at different breakpoints.

**Example scenario:**

```html
<lg-card lgMargin="8" lgMarginNoneAt="md"></lg-card>
```

This will:
- Apply `margin: var(--space-8)` which is responsive across all breakpoints
- Override to `margin: 0` **only at the `md` breakpoint** (48rem - 63.94rem)
- At `lg`, `xl`, and `xxl` breakpoints, `var(--space-8)` takes effect again with the appropriate values for those breakpoints

**Important:** The `NoneAt` classes use **range-based media queries** to ensure they only apply at the specified breakpoint, not at larger breakpoints. This allows the responsive spacing variables to work correctly across your design.

#### Migration from SpacingResponsive

If you were previously using the `SpacingResponsive` object syntax with `'none'`:

**Before:**
```html
<lg-card [lgMarginRight]="{ sm: 'none', md: '4' }"></lg-card>
```

**After:**
```html
<lg-card lgMarginRight="4" lgMarginRightNoneAt="sm"></lg-card>
```

The new approach is more compatible with responsive CSS variables and provides better specificity control.

## Inputs

The current available spacing variants are:
<pre><code className="language-text">
{(() => {
  const spacingVars = getDefaultSpacingVariables();
  const variants = Object.keys(spacingVars)
    .filter(key => key.startsWith('--space-'))
    .map(key => key.replace('--space-', ''))
    .sort((a, b) => {
      // Handle 'none' specially
      if (a === 'none') return -1;
      if (b === 'none') return 1;
      // Sort numbers numerically
      return parseInt(a) - parseInt(b);
    })
    .map(variant => `'${variant}'`)
    .join(', ');

  return `'none', ${variants}`;
})()}
</code></pre>

The current available breakpoints are `sm`, `md`, `lg`, `xl`, `xxl`

| Name                       | Description                                                           |                  Type                   | Default | Required |
|----------------------------|-----------------------------------------------------------------------|:---------------------------------------:|:-------:|:--------:|
| `lgMargin`                 | The margin variant applied to all sides                               | `SpacingVariant` \| `SpacingResponsive` | `null`  |    No    |
| `lgMarginTop`              | The margin variant applied to the top                                 | `SpacingVariant` \| `SpacingResponsive` | `null`  |    No    |
| `lgMarginRight`            | The margin variant applied to the right                               | `SpacingVariant` \| `SpacingResponsive` | `null`  |    No    |
| `lgMarginBottom`           | The margin variant applied to the bottom                              | `SpacingVariant` \| `SpacingResponsive` | `null`  |    No    |
| `lgMarginLeft`             | The margin variant applied to the left                                | `SpacingVariant` \| `SpacingResponsive` | `null`  |    No    |
| `lgMarginHorizontal`       | The margin variant applied to the left and the right                  | `SpacingVariant` \| `SpacingResponsive` | `null`  |    No    |
| `lgMarginVertical`         | The margin variant applied to the top and the bottom                  | `SpacingVariant` \| `SpacingResponsive` | `null`  |    No    |
| `lgMarginNoneAt`           | Set margin to none at a specific breakpoint                           |              `Breakpoints`              | `null`  |    No    |
| `lgMarginTopNoneAt`        | Set margin-top to none at a specific breakpoint                       |              `Breakpoints`              | `null`  |    No    |
| `lgMarginRightNoneAt`      | Set margin-right to none at a specific breakpoint                     |              `Breakpoints`              | `null`  |    No    |
| `lgMarginBottomNoneAt`     | Set margin-bottom to none at a specific breakpoint                    |              `Breakpoints`              | `null`  |    No    |
| `lgMarginLeftNoneAt`       | Set margin-left to none at a specific breakpoint                      |              `Breakpoints`              | `null`  |    No    |
| `lgMarginHorizontalNoneAt` | Set margin-left and margin-right to none at a specific breakpoint     |              `Breakpoints`              | `null`  |    No    |
| `lgMarginVerticalNoneAt`   | Set margin-top and margin-bottom to none at a specific breakpoint     |              `Breakpoints`              | `null`  |    No    |

***

## Related

* [Padding directive](./?path=/docs/helpers-directives-padding-guide--docs)
* [Row gap directive](./?path=/docs/helpers-directives-row-gap-guide--docs)

<Markdown>
  {Feedback}
</Markdown>
