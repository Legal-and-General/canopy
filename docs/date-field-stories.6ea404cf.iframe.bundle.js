(self.webpackChunk_legal_and_general_canopy=self.webpackChunk_legal_and_general_canopy||[]).push([[26944],{"./projects/canopy/src/lib/focus/focus.directive.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{t:()=>LgFocusDirective});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs");let LgFocusDirective=class LgFocusDirective{constructor(){this.el=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.WQX)(_angular_core__WEBPACK_IMPORTED_MODULE_2__.aKT)}ngOnChanges({lgFocus}){if(lgFocus.currentValue){this.el.nativeElement.focus()}}static{this.propDecorators={lgFocus:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_2__.pde}]}}};LgFocusDirective=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.WLR)({selector:"[lgFocus]",standalone:!0})],LgFocusDirective)},"./projects/canopy/src/lib/forms/date/date-field.component.scss?ngResource"(module,__unused_webpack_exports,__webpack_require__){var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/@angular-devkit/build-angular/node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".lg-date-field {\n  display: block;\n  margin-bottom: var(--component-margin);\n}\n\n.lg-date-field__fields {\n  display: flex;\n}\n\n.lg-date-field__date,\n.lg-date-field__month,\n.lg-date-field__year {\n  display: flex;\n  flex-direction: column;\n  margin-right: var(--space-4);\n}\n.lg-date-field__date .lg-input-field .lg-input-field__inputs,\n.lg-date-field__month .lg-input-field .lg-input-field__inputs,\n.lg-date-field__year .lg-input-field .lg-input-field__inputs {\n  width: 100%;\n}\n\n.lg-date-field__month,\n.lg-date-field__date {\n  width: 4rem;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./projects/canopy/src/lib/forms/date/date-field.component.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{N:()=>LgDateFieldComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var date_field_componentngResource=__webpack_require__("./projects/canopy/src/lib/forms/date/date-field.component.scss?ngResource"),date_field_componentngResource_default=__webpack_require__.n(date_field_componentngResource),root_effect_scheduler=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),debug_node=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),isValid=__webpack_require__("./node_modules/date-fns/isValid.js"),parseISO=__webpack_require__("./node_modules/date-fns/parseISO.js"),hint_component=__webpack_require__("./projects/canopy/src/lib/forms/hint/hint.component.ts"),error_state_matcher=__webpack_require__("./projects/canopy/src/lib/forms/validation/error-state-matcher.ts"),validation_component=__webpack_require__("./projects/canopy/src/lib/forms/validation/validation.component.ts");function omit(obj,key){if(!obj)return obj;const{[key]:_,...newObj}=obj;return 0===Object.keys(newObj).length?null:newObj}var input_directive=__webpack_require__("./projects/canopy/src/lib/forms/input/input.directive.ts"),margin_directive=__webpack_require__("./projects/canopy/src/lib/spacing/margin/margin.directive.ts"),input_field_component=__webpack_require__("./projects/canopy/src/lib/forms/input/input-field.component.ts"),label_component=__webpack_require__("./projects/canopy/src/lib/forms/label/label.component.ts"),focus_directive=__webpack_require__("./projects/canopy/src/lib/focus/focus.directive.ts");let nextUniqueId=0;const labelFieldMap={date:"day",month:"month",year:"year"};let LgDateFieldComponent=class LgDateFieldComponent{set hintElement(element){this._hintElement=element}set errorContentElement(element){this._validationElement=element}constructor(){this.errorState=(0,root_effect_scheduler.WQX)(error_state_matcher.B),this.ngControl=(0,root_effect_scheduler.WQX)(fesm2022_forms.vO,{self:!0,optional:!0}),this.parentFormGroupDirective=(0,root_effect_scheduler.WQX)(fesm2022_forms.j4,{optional:!0,skipSelf:!0}),this.cdr=(0,root_effect_scheduler.WQX)(core.ChangeDetectorRef),this.uniqueId=nextUniqueId++,this.subscriptions=[],this.disabled=!1,this.dateId="lg-input-date-"+this.uniqueId++,this.monthId="lg-input-month-"+this.uniqueId++,this.yearId="lg-input-year-"+this.uniqueId++,this.class=!0,null!=this.ngControl&&(this.ngControl.valueAccessor=this),this.date=new fesm2022_forms.hs(null,[fesm2022_forms.k0.required,fesm2022_forms.k0.pattern(/^\d{1,2}$/),fesm2022_forms.k0.min(1),fesm2022_forms.k0.max(31)]),this.month=new fesm2022_forms.hs(null,[fesm2022_forms.k0.required,fesm2022_forms.k0.pattern(/^\d{1,2}$/),fesm2022_forms.k0.min(1),fesm2022_forms.k0.max(12)]),this.year=new fesm2022_forms.hs(null,[fesm2022_forms.k0.required,fesm2022_forms.k0.pattern(/^\d\d\d\d$/)]),this.dateFormGroup=new fesm2022_forms.J3({date:this.date,month:this.month,year:this.year},{updateOn:"blur"})}ngOnInit(){const validators=[this.validate.bind(this)];this.ngControl&&this.ngControl.control&&(this.ngControl.control.validator&&validators.push(this.ngControl.control.validator),this.ngControl.control.setValidators(validators),this.ngControl.control.updateValueAndValidity()),this.subscriptions.push(this.dateFormGroup.valueChanges.subscribe(date=>{const day=date.date?("0"+date.date).slice(-2):"",month=date.month?("0"+date.month).slice(-2):"",year=date.year?date.year:"",formatedDate=day||month||year?`${year}-${month}-${day}`:"";this.onChange(formatedDate)}),this.parentFormGroupDirective.ngSubmit.pipe((0,filter.p)(({type})=>"submit"===type)).subscribe(event=>{this.formGroupDirective.onSubmit(event),this.ngControl.control.updateValueAndValidity()}))}ngAfterViewInit(){const ids=[];this.ariaDescribedBy&&ids.push(this.ariaDescribedBy),this._hintElement?.id&&ids.push(this._hintElement.id),this._validationElement?.id&&ids.push(this._validationElement.id),this.ariaDescribedBy=ids.length?ids.join(" "):null,this.cdr.detectChanges()}isControlInvalid(control,form){return this.errorState.isControlInvalid(control,form)}ngOnDestroy(){this.subscriptions.forEach(subscription=>subscription.unsubscribe())}writeValue(dateString){if(!dateString)return;const[year,month,date]=dateString.split(/-/);this.dateFormGroup.setValue({date,month,year},{emitEvent:!1})}validate(control){if(this.date.setErrors(omit(this.date.errors,"invalidDate")),this.month.setErrors(omit(this.month.errors,"invalidDate")),this.year.setErrors(omit(this.year.errors,"invalidDate")),!this.date.value&&!this.month.value&&!this.year.value)return null;const invalidFields=[];Object.keys(this.dateFormGroup.controls).forEach(fieldName=>{this.dateFormGroup.controls[fieldName].invalid&&(this.dateFormGroup.controls[fieldName].dirty||this.formGroupDirective&&this.formGroupDirective.submitted)&&invalidFields.push(fieldName)});const invalidFieldNames=[],requiredFieldNames=[];invalidFields.forEach(fieldName=>{this.dateFormGroup.controls[fieldName].hasError("required")?requiredFieldNames.push(labelFieldMap[fieldName]):invalidFieldNames.push(labelFieldMap[fieldName])});const error={};if(invalidFieldNames.length)switch(invalidFieldNames.length){case 1:error.invalidField=invalidFieldNames[0];break;case 2:error.invalidFields=invalidFieldNames;break;default:error.invalidDate=!0}else if(requiredFieldNames.length)switch(requiredFieldNames.length){case 1:error.requiredField=requiredFieldNames[0];break;case 2:error.requiredFields=requiredFieldNames}else(this.date.valid&&this.month.valid&&this.year.valid||this.formGroupDirective&&this.formGroupDirective.submitted)&&!(0,isValid.f)((0,parseISO.H)(control.value||""))&&(this.date.setErrors(error),this.month.setErrors(error),this.year.setErrors(error),error.invalidDate=!0);return Object.keys(error).length?error:null}onBlur(){this.dateFormGroup.touched&&this.onTouched()}onTouched(_){}onChange(date){this.value=date}registerOnChange(fn){this.onChange=fn}registerOnTouched(fn){this.onTouched=fn}setDisabledState(isDisabled){isDisabled?(this.date.disable(),this.month.disable(),this.year.disable()):(this.date.enable(),this.month.enable(),this.year.enable())}static{this.ctorParameters=()=>[]}static{this.propDecorators={value:[{type:debug_node.pde}],disabled:[{type:debug_node.pde}],focus:[{type:debug_node.pde}],dateId:[{type:debug_node.pde}],monthId:[{type:debug_node.pde}],yearId:[{type:debug_node.pde}],ariaDescribedBy:[{type:debug_node.pde}],class:[{type:debug_node.g$6,args:["class.lg-date-field"]}],hintElement:[{type:core.ViewChild,args:[hint_component.m]}],errorContentElement:[{type:core.ContentChild,args:[validation_component.Q]}],formGroupDirective:[{type:core.ViewChild,args:["dateFormDirective"]}]}}};LgDateFieldComponent=(0,tslib_es6.Cg)([(0,debug_node.uAl)({selector:"lg-date-field",template:'<fieldset\n  [attr.aria-describedby]="ariaDescribedBy || null"\n  [attr.tabindex]="focus ? \'-1\' : null"\n  [lgFocus]="focus"\n>\n  <legend lg-label>\n    <ng-content />\n  </legend>\n  <lg-hint>For example, 27 12 1977</lg-hint>\n  <div\n    class="lg-date-field__fields"\n    [formGroup]="dateFormGroup"\n    #dateFormDirective="ngForm"\n  >\n    <div class="lg-date-field__date">\n      <lg-input-field lgMarginBottom="none">\n        Day\n        <input\n          lgInput\n          (blur)="onBlur()"\n          (input)="date.setValue($event.target.value)"\n          formControlName="date"\n          inputmode="numeric"\n          maxlength="2"\n          size="2"\n          type="text"\n        />\n      </lg-input-field>\n    </div>\n\n    <div class="lg-date-field__month">\n      <lg-input-field lgMarginBottom="none">\n        Month\n        <input\n          lgInput\n          (blur)="onBlur()"\n          (input)="month.setValue($event.target.value)"\n          formControlName="month"\n          inputmode="numeric"\n          maxlength="2"\n          size="3"\n          type="text"\n        />\n      </lg-input-field>\n    </div>\n\n    <div class="lg-date-field__year">\n      <lg-input-field lgMarginBottom="none">\n        Year\n        <input\n          lgInput\n          (blur)="onBlur()"\n          (input)="year.setValue($event.target.value)"\n          formControlName="year"\n          inputmode="numeric"\n          maxlength="4"\n          size="4"\n          type="text"\n        />\n      </lg-input-field>\n    </div>\n  </div>\n\n  <ng-content select="lg-validation" />\n</fieldset>\n',encapsulation:debug_node.gXe.None,imports:[focus_directive.t,label_component.d,fesm2022_forms.X1,input_field_component.v,margin_directive.X,input_directive.d,hint_component.m],styles:[date_field_componentngResource_default()]})],LgDateFieldComponent)},"./projects/canopy/src/lib/forms/date/docs/date-field.stories.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DateInput:()=>DateInput,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs"),_angular_forms__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),_storybook_angular__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),_date_field_component__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./projects/canopy/src/lib/forms/date/date-field.component.ts");const template='\n<lg-date-field [focus]="focus" formControlName="date">\n  {{ label }}\n</lg-date-field>\n';let ReactiveFormComponent=class ReactiveFormComponent{set disabled(disabled){!0===disabled?this.form.controls.date.disable():this.form.controls.date.enable()}get disabled(){return this.form.controls.date.disabled}constructor(){this.fb=(0,_angular_core__WEBPACK_IMPORTED_MODULE_1__.WQX)(_angular_forms__WEBPACK_IMPORTED_MODULE_3__.ze),this.inputChange=new _angular_core__WEBPACK_IMPORTED_MODULE_2__.bkB,this.form=this.fb.group({date:{value:"1970-01-01",disabled:!1}}),this.form.valueChanges.subscribe(val=>this.inputChange.emit(val))}static{this.ctorParameters=()=>[]}static{this.propDecorators={label:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_2__.pde}],focus:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_2__.pde}],disabled:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_2__.pde}],inputChange:[{type:_angular_core__WEBPACK_IMPORTED_MODULE_2__.k7i}]}}};ReactiveFormComponent=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.uAl)({selector:"lg-reactive-form",template:` <form [formGroup]="form">${template}</form> `,imports:[_angular_forms__WEBPACK_IMPORTED_MODULE_3__.X1,_date_field_component__WEBPACK_IMPORTED_MODULE_5__.N]})],ReactiveFormComponent);const __WEBPACK_DEFAULT_EXPORT__={title:"Patterns/Date input/Examples",tags:["pending"],component:_date_field_component__WEBPACK_IMPORTED_MODULE_5__.N,decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_4__.Iz)({imports:[ReactiveFormComponent]})],argTypes:{inputChange:{action:"Input change",table:{disable:!0}},dateId:{table:{disable:!0}},monthId:{table:{disable:!0}},yearId:{table:{disable:!0}},focus:{description:"Set the focus on the fieldset.",table:{type:{summary:"boolean"},defaultValue:{summary:!1}}},disabled:{description:"Set the inputs to disabled.",table:{type:{summary:"boolean"},defaultValue:{summary:!1}}},ariaDescribedBy:{table:{disable:!0}},value:{table:{disable:!0}},_hintElement:{table:{disable:!0}},class:{table:{disable:!0}},date:{table:{disable:!0}},_validationElement:{table:{disable:!0}},isControlInvalid:{table:{disable:!0}},onChange:{table:{disable:!0}},ngOnDestroy:{table:{disable:!0}},ngOnInit:{table:{disable:!0}},ngAfterViewInit:{table:{disable:!0}},onBlur:{table:{disable:!0}},onTouched:{table:{disable:!0}},registerOnChange:{table:{disable:!0}},registerOnTouched:{table:{disable:!0}},setDisabledState:{table:{disable:!0}},writeValue:{table:{disable:!0}},formGroupDirective:{table:{disable:!0}},validate:{table:{disable:!0}},dateFormGroup:{table:{disable:!0}},month:{table:{disable:!0}},subscriptions:{table:{disable:!0}},year:{table:{disable:!0}}}},DateInput={name:"Date input",render:args=>({props:args,template:'\n      <lg-reactive-form\n        (inputChange)="inputChange($event)"\n        [disabled]="disabled"\n        [label]="label"\n        [focus]="focus"\n      ></lg-reactive-form>\n    '}),args:{disabled:!1,label:"Date of birth",focus:!1},parameters:{docs:{source:{code:template}}}},__namedExportsOrder=["DateInput"];DateInput.parameters={...DateInput.parameters,docs:{...DateInput.parameters?.docs,source:{originalSource:'{\n  name: \'Date input\',\n  render: (args: LgDateFieldComponent) => ({\n    props: args,\n    template: `\n      <lg-reactive-form\n        (inputChange)="inputChange($event)"\n        [disabled]="disabled"\n        [label]="label"\n        [focus]="focus"\n      ></lg-reactive-form>\n    `\n  }),\n  args: {\n    disabled: false,\n    label: \'Date of birth\',\n    focus: false\n  },\n  parameters: {\n    docs: {\n      source: {\n        code: template\n      }\n    }\n  }\n}',...DateInput.parameters?.docs?.source}}}}}]);